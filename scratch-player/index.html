<!DOCTYPE html>
<html manifest="/manifest/24235365">
<head>
    <meta charset=utf-8>
    <title>Scratch HTML5</title>

    <!-- iPad p+roperties: set width, disable pinch zoom -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="user-scalable=no, width=540">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <link rel="stylesheet" href="player.css">
    <link rel="stylesheet" href="index.css">

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script>
        // Get the project ID from #<projectID>
        var projectId = window.location.hash.substr(1);

        // Check to see if the project id exists
        if(projectId === "")
        {
            alert("No project ID.");
        } else {
            // If so, set the HTML manifest to the manifest file.

            $("html").attr("manifest", "/manifest/" + projectId);

            var appCache = window.applicationCache;
            
            appCache.onprogress = function(e) {
                $(".downloading-text").text("Downloading: " + e.loaded + "/" + e.total);
            }

            appCache.oncached = function(e) {
                $(".downloading-text").text("Downloaded!");
            }

            appCache.onnoupdate = function(e) {
                $(".downloading-text").text("Downloaded. No updates.");
            }

            appCache.onupdateready = function(e) {
                console.log("Updating AppCache");
                appCache.swapCache();
            }

            appCache.onchecking = function(e) {
                console.log("Checking for updates...");
            }
        }
    </script>
</head>
    <body>
    <div id="player-container">
        <div class="arrow vertical" id="up"></div>
        <div class="arrow vertical" id="down"></div>
        <div class="arrow horizontal" id="left"></div>
        <div class="arrow horizontal" id="right"></div>
        <div id="player-header">
            <div id="player-header-preload"></div>
            <div id="player-header-version">HTML5</div>
            <button id="toggle-fullscreen" tabindex="1"></button>
            <button id="trigger-stop" tabindex="3"></button>
            <button id="trigger-green-flag" tabindex="2"></button>
        </div>
        <div id="player-content">
            <div id="container"></div>
            <div id="overlay"></div>
            <div id="preloader">
                <div id="preloader-progress"><div id="preloader-progress-bar"></div></div>
                <div id="preloader-caption">Loading project&hellip;</div>
                <div id="preloader"-details></div>
            </div>
        </div>
    </div>

    <div id="project-picker">
        <span id="address-hint">http://scratch.mit.edu/projects/</span><input id="project-id" placeholder="10000160"><button id="go-project">&rarr;</button>
    </div>

    <h1 class="downloading-text">Scratch HTML5 player</h1>
    <p>The Scratch HTML5 player is still in development. Feedback is welcome! Please report any bugs (or differences from the Flash player) <a href="https://github.com/LLK/scratch-html5">on Github</a>.</p>

    <script type="text/JavaScript" src="Scratch.js"></script>
    <script type="text/javascript">
      (function() {
        var project_id = location.hash && parseInt(location.hash.substr(1)) || 10000160;
        new Scratch(project_id);
      }());
    </script>
</body>
</html>